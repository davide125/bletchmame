language: cpp
os: windows
script:
  - choco install wixtoolset -y --version 3.10.3.300702
  - dir "c:\Program Files (x86)"
  - dir "c:\Program Files (x86)\WiX Toolset v3.10\bin\candle.exe"
  - dir "c:\Program Files (x86)\WiX Toolset v3.10\bin\light.exe"
  - /c/program\ files\ \(x86\)/WiX\ Toolset\ v3.10/bin/candle -help
  - /c/program\ files\ \(x86\)/WiX\ Toolset\ v3.10/bin/light -help
  - choco install wxWidgets --version 3.1.2
  - pushd C:/wxWidgets-3.1.2/build/msw ; mingw32-make -f makefile.gcc SHARED=0 UNICODE=1 BUILD=release setup_h; popd
  - pushd C:/wxWidgets-3.1.2/build/msw ; mingw32-make -f makefile.gcc SHARED=0 UNICODE=1 BUILD=release -j 8; popd
  - mingw32-make WXWIDGETS_DIR=C:/wxWidgets-3.1.2 -j 8
  - /c/program\ files\ \(x86\)/WiX\ Toolset\ v3.10/bin/candle -v bletchmame.wxs -out bletchmame.wixobj
  - /c/program\ files\ \(x86\)/WiX\ Toolset\ v3.10/bin/light -v -ext WixUIExtension bletchmame.wixobj -out BletchMAME.msi
  - mkdir rel
  - move BletchMAME.msi rel

cache:
  directories:
  - C:/wxWidgets-3.1.2/build/msw/gcc_mswu
  
deploy:
  provider: s3
  bucket: bletchmame
  skip_cleanup: true
  local_dir: rel
  upload-dir: files
